FROM mhart/alpine-node:14
WORKDIR /app

COPY ./build /app
COPY crontab.txt /crontab.txt
COPY cronscript.sh /cronscript.sh
COPY package.json /app
RUN apk add --no-cache tini 
RUN  /usr/bin/crontab /crontab.txt 
RUN  chmod a+x /cronscript.sh 
RUN  yarn install --production=true --no-bin-links --ignore-optional

ENTRYPOINT ["/sbin/tini", "--"]
CMD [ "/usr/sbin/crond", "-f", "-l", "8" ]